# NVIDIA

Данная статья описывает процесс установки и настройки проприетарного драйвера графических карт NVIDIA

## Смена открытых драйверов на проприетарные

Для перехода с nouveau на NVIDIA рекомендуется сначала обновить ядро:

```shell
su -l root
update-kernel
```
Для вступление в силу необходимо перезагрузить операционную систему

Установим проприетарный драйвера NVIDIA:

```shell
su -l root
rpm -e $(rpm -qf `modinfo -F filename nouveau`)
apt-get install nvidia_glx_common && nvidia-install-driver
make-initrd
```

::: danger
Не следует запускать фирменный инсталлятор драйвера NVIDIA из .run-файла!
:::

## Утилита NVIDIA Settings

Утилита для настройки и оптимизации графических параметров на компьютерах с видеокартами Nvidia. Она позволяет пользователям настраивать качество изображения, разрешение экрана, а также различные параметры, связанные с производительностью видеокарты. С помощью Nvidia Settings можно также включить или отключить определенные функции, такие как вертикальная синхронизация или сглаживание.

В зависимости от сессии Xorg или Wayland возможны различаться набор настроек в утилите NVIDIA Settings. Например, в Wayland нельзя настроить вертикальную синхронизацию и тройную буферизацию, так как они работают по-другому в этом окружении. Также в Wayland нет поддержки G-Sync, так как эта технология работает только с Nvidia и требует специального оборудования. В целом, основные функции Nvidia Settings доступны в обоих окружениях, но некоторые дополнительные возможности могут быть ограничены.

### Установка из репозитория
**NVIDIA Settings** можно установить любым привычным и удобным способом

**Установка через терминал**
::: code-group

```shell[apt-get]
su -
apt-get update
apt-get install nvidia-settings
```
```shell[epm]
epm -i nvidia-settings
```
:::

## Cессия Wayland на закрытых драйверах NVIDIA

Активируем **Wayland** сессию в **ALT Regular Gnome** для видеокарт NVIDIA с установленными проприетарными драйверами.

:::info
Закрытый драйвер Nvidia поддерживает GBM, Wayland и аппаратное ускорение с помощью XWayland, начиная с драйвера серии 470.x
:::

Для каждого графического устройства NVIDIA существует свой диапазон поддерживаемых драйверов, конкретную информацию вы можете узнать на сайте производителя [Загрузка драйверов NVIDIA](https://www.nvidia.com/Download/Index.Aspx?lang=ru)

```shell
su -
mcedit /etc/sysconfig/grub2
```
Добавляем в параметр `GRUB_CMDLINE_LINUX_DEFAULT` значение `nvidia-drm.modeset=1` и сохраняем.

```shell
su -
grub-mkconfig -o /boot/grub/grub.cfg
ln -s /dev/null /etc/udev/rules.d/61-gdm.rules
```

Перезагружаем операционную систему, выберите в списке сессию Gnome.

::: tip
Wayland не работает без `nvidia_drm.modeset=1`, а modeset не работает на драйверах младше 400-ой серии

Несовместимые карты:
- GT750M Mac edition (устанавливается драйвер 390-ой серии, при 417-ой максимально доступной)
:::

## «Неизвестный монитор» в настройках дисплеев в сессии Wayland

Внесем изменение в конфигурацию **GRUB**:

```shell
su -
mcedit /etc/sysconfig/grub2
```

Добавляем в параметр `GRUB_CMDLINE_LINUX_DEFAULT` значение `initcall_blacklist=simpledrm_platform_driver_init` и сохраняем.

```shell
su -
grub-mkconfig -o /boot/grub/grub.cfg
```

:::info 
Данная проблема может привести к некорректной работе устройств ввода: мышка, тачпад. Особенно часто данные проблемы проявляются в играх.
:::

:::info 
Данное решение приводит к невозможности входа в tty.
:::